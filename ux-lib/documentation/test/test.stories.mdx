import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="General|Test" />

# Test avec Jest

Jest utilise jsdom pour simuler le dom sous node.
La version de jest actuelle utilise une vieille version de jsdom qui
ne gère pas les webcomponents.
Pour l'instant on est obligé d'utiliser jest-environment-jsdom-sixteen qui update la version
de jsdom utilisé par jest. Il faut aussi spécifier dans le fichier jest.config.js

```json
  testEnvironment: 'jest-environment-jsdom-sixteen'
```

# DEPRECIE Test

## Installation

On a besoin en WCT en global :

```js
npm install -g web-component-tester
```

Pour faire les tests il faut faire (exemple pour cmb)

```js
npm run test:cmb
```

Ceci va lancer les tests unitaires et les tests automatiques d'accessibilités pour le cmb.

Pour les autres efs remplacer cmb par abei par exemple.

Puis aller sur http://localhost:8081/components/components-lib/generated-index.html?cli_browser_id=0

## Doc

https://polymer-library.polymer-project.org/1.0/docs/tools/tests
https://github.com/Polymer/tools/tree/master/packages/web-component-tester

## Rajouter les test pour un nouveau wc

En premier lieu il faut savoir si le composant est disponible pour les autres efs.
Disons qu'il est disponible pour le cmb et abei il faut dans pour chaque efs faire :

- test/cmb/index.html
- test/abei/index.html
- ...
- test/EFS/index.html

```html
<script>
  WCT.loadSuites(
    [
      "../src/app/components/atoms/bux-message/message.component.spec.html",
      "../src/app/components/atoms/bux-select/select.component.spec.html",
      RAJOUTER ICI LE CHEMIN DU NOUVEAU FICHIER DE TEST
    ]
  );
</script>
```

## Note sur WCT

Ce module prends un fichier de configuration (automatiquement wct.conf.js)

Pour en spécifier un autre on peut dans la package.json rajouter l'option :

- --configFile
- ou -config-file

Je ne sais pas quelle option fonctionne.
